# 이것이 우분투 리눅스다 정리

## CH.4 서버를 구축할 때 알아야 할 필수 개념과 명령어

* Tap : 예상단어가 한개만 있을때는 한번만 눌러도 되지만, 여러개가 있는경우 두번 눌러서 후보군을 보여준다.

* /etc/skel : 처음 유저가만들어 질때 유저의 디렉토리에 기본으로 생성되는 파일들이 모여있는 곳


-----

#### 파일 유형
파일의 종류는 d,-,b,c,l 5가지 경우 등이 있다.

* d : 디렉토리, 폴더
* - : 일반 파일
* b : block Dvice를 의미하며 하드디스크, 플로피 디스크, CD/DVD 등의 저장장치
* c : Character Device, 마우스 키보드 프린터 등의 입출력 장비
* l : Link, 윈도우의 바로가기 아이콘과 같이 연결되어 있는 파일

#### CD-ROM/USB

> CD/DVD 장치 이름이 /dev/cdrom 으로 사용했는데, /dev/cdrom 과 /dev/sr0은 동일하게 취급된다. (/dev/cdrom은 /dev/sfr0에 링크된 파일이기 때문)
그러므로 리눅스에서는 /dev/sr0라는 이름은 변경될 수 있지만, /dev/cdrom은 대부분 고정되어 있다.

#### 링크 (하드링크 vs 심볼릭링크)
하드링크는 원본 파일 데이터를 그대로 사용하는 링크 방식이므로, 크기와 inode가 같다. 그러나 심볼릭 링크는 원본 파일의 위치를 가리키는 포인터 이기에
8바이트로 원본 파일의 크기와 다르다.

하드링크는 원본파일의 디렉토리가 변경되어도 그대로 작동하지만, 심볼릭 링크는 원본 파일의 디렉토리가 변경되면 연결이 끊어지므로 실행이 되지 않는다.

#### 의존성 문제 feat. apt-get
우분투에서 패키지를 설치할때 우선 설치해야하는 패키지가 있다면(의존성 문제), dpkg를 사용한 설치에서는 설치를 멈춘다.

이때 apt-get 명령어를 사용해 패키지 의존성 문제를 자동으로 해결해 준다. 또한 .deb 파일을 저장소에서 알아서 받아와 설치한다.


## 프로세스, 데몬, 서비스

* 프로세스 : '하드디스크에 저장된 실행 코드(프로그램)가 메모리에 올라가 활성화 된 상태'
    * 포그라운드 프로세스 : 실행하면 화면에 나타나서 사용자와 상호작용을 하는 프로세스
    * 백그라운드 프로세스 : 실행은 되었지만,  화면에 나타나지 않고 뒤에서 실행되는 프로세스
    * 프로세스 번호 : 활성화된 프로세스를 구별하기 위해 각 프로세스에 할당된 고유 번호
    * 작업 번호 : 현재 실행되는 백그라운드 프로세스의 순차 번호
    
* 서비스(데몬) : 서버 프로세스, 서비스는 웹 서버, 네임 서버 등의 프로세스를 지칭한다. 서비스는 눈에 보이지 않고, 현재 시스템에서 동작 중인 프로세스
이므로 백그라운드 프로세스의 일종이라고 할 수 있다.
  * 서비스 : 평상시에도 늘 가동하는 서버 프로세스
  * 소켓 : 필요할 떄만 작동하는 서버 프로세스
> 서비스와 소켓은 'systemd'라고 부르는 서비스 매니저 프로그램으로 작동시키거나 관리한다.


## CH.6 하드디스크 관리와 사용자별 공간 할당

#### 하드디스크 추가 후 리눅스에서 사용하기
* 하드디스크 추가 -> 장착한 하드디스크 파티션 할당(*fdisk 하드디스크디렉토리) -> 파티션 장치의 이름을 파일시스템 형식으로 포맷(ext4) -> 파일 시스템을 사용하기 위해 디렉터리에 마운트

### RAID
RAID란 여러개의 하드를 하나로 묶어서 사용하는 방식이다. Linear, 0, 5, 6, 1+0 등 여러가지 방식이 존재한다. RAID는 하드웨어 RAID, 소프트웨어 RAID가 있다. 

#### 소프트웨어 RAID
리눅스에서는 RAID를 만들기 위해선 우선 하드디스크의 파티션을 할당하고, mdadm을 통해서 RAID를 만든다.

* mdadm --create <만들 RAID의 주소> --level=<Linear, 0,1,5,6> --raid-devices=<disk number> <disk address> , .. : RAID 만들기
   
* mdadm --detail <RAID의 주소> : RAID 정보
* mdadm --detail --scan : RAID들의 정보 및 UUID

### LVM(Logical Volume Manager)
논리 하드디스크 관리자로, RAID와 기본 기능은 비슷해 보이지만, 더 많은 기능이 있다.

> LVM의 주요한 용도는 여러 개의 하드디스크를 합쳐허 한개의 파티션으로 구성한 후에, 다시 필요에 따라서 다시 나눌 수 있다. 또는 한 개의 하드디스크로
LVM으로 구성하고 다시 파티션을 구분할 수도 있다.

* 물리 볼륨(Physical Volume) : /dev/sda1, /dev/sdb1 등의 파티션을 의미
* 볼륨 그룹(Volume Group) : 물리 볼륨을 합쳐서 1개의 물리 그룹으로 만든 것
   * vgcreate <VG 이름> <디스크 주소>
* 논리 볼륨(Logical Volume) : 볼륨 그룹을 1개 이상으로 나눈 것, 논리적 그룹이라고도 한다.
   * lvcrate --size <할당용량> --name <이름> <VG 이름>
   
## 사용자별로 공간 할당하기

리눅스는 여러 명의 사용자가 동시에 접속할 수 있고, 한놈이 시스템 하드를 꽉 채워버려서 전체가 가동되지 않게 하는 문제가 생길 수 있다. 이런 상황을
방지하기 위해선 사용자 별로 사용할 수 있는 용량을 제한해야 한다. 이를 **쿼터**라 한다.  즉 사용자가 적정 용량 이상을 사용하지 못하게 함으로써, 할당된 양만큼의 공간만 사용하게 한다면 아무런 문제가 발생하지 않을 것이다.

### 쿼터
쿼터란 파일 시스템마다 사용자나 그룹이 생성할 수 있는 파일의 용량과 개수를 제한하는 것을 말한다.


## CH.9 네임 서버 설치와 운영

* 127.0.1.1 : DNS서버, 즉 네임서버가 바로 이 서버에 설치 되어있다는 의미

* DNS(네임서버) : 네임서버는 URL 주소를 IP주소로 변환해주는 서비스를 제공할 뿐, 직접적으로 컴퓨터에 연결된 네트워크에 영향을 미치지 않는다.

### 마스터 네임 서버
자신이 별도로 관리하는 도메인이 있고, 외부에서 자신이 관리하는 컴퓨터의 IP를 물어볼 때, 자신의 DB에서 찾아서 알려주는 네임서버를 
마스터 네임서버라고 한다.

> john.com과 같은 도메인에 속해 있는 컴퓨터들의 이름을 관리하고, 외부에서 www.john.com 이나 ftp.john.com 등의 컴퓨터 IP주소를 알기를 원할 떄
해당 컴퓨터의 IP주소를 알려주는(ftp.john.com 을 물어보면 알려주는) 네임서버다.

* 정방향 영역(포워드 존) : 도메인이름을 통해서 IP주소를 알아내는 방식. IP주소를 통해서 도메인을 알아내는 방식은 역방향 영역(리버스 존)이라고 한다.

## CH.10 메일 서버 설치와 운영

### 이메일 송수신에 사용되는 프로토콜

* SMTP(Simple Mail Transfer Protocol) : 클리이언트가 메일을 보내거나, 메일 서버끼리 메일을 주고 받을 떄 사용한다.
* POP3(Post Office Protocol) : 메일 서버에 도착되어 있는 메일을 클라이언트로 가져올떄 사용
* IMAP(Internet Mail Access Protocol) : POP3와 용도 동일


## CH.11 데이터베이스 서버 구축과 운영

* DBMS(DataBase Management System) : 데이터베이스를 관리하기 위한 소프트웨어
* RDBMS(Relational DBMS) : 테이블과의 관계성(주키, 외래키 등)을 기반으로 둔 DBMS, 오라클, SQL Server, MariaDB 등이 대부분 관계형DBMS이다.

* ODBC(Open DataBase Connectivity) : Windows의 응용프로램과 MariaDB 서버사이에 통신이 이루어지도록 연결하는 역할

## CH.12 웹 서버 설치와 운영

* LAPM(Linux, Apache, PHP, MySQL) : 우분투 리눅스에서 많이 사용하는 웹 프로그래밍 언어를 약어로 표현
   * apt-get -y install lamp-server^ : 위에 말한 apache, PHP, mysql-server를 한번에 설치 할 수 있다.

### 웹하드의 설치와 운영

웹하드와 클라우드의 차이는 무엇일까. 웹하드는 따로 서버에 업로드 해야 하지만, 클라우드는 사용자의 로컬의 폴더와 파일을 생성/수정/삭제하면 자동으로
웹서버에 동기화 되어 동일한 파일로 유지가 된다.

## CH.13 FTP 서버 설치와 운영
**FTP(File Transfer Protocol)** : 인터넷 상에서 파일을 주고 받을 떄 사용하는 전송방식. 파일 전송 전용이다보니 다른 프로토콜(http, scp 등)에 비해
속도면에서 우위를 가지고 있고, 이어받기 등의 부가 옵션등을 지원한다.

FTP 역시 SSH와 마찬가지로 서버와 클라이언트로 구성되어 있으며, 리눅스에서 사용되는 FTP 서버의 종류로는 vsftpd, proftpd, atftpd, tftpd 등이 있으며, 과거에는 proftpd를 많이 사용했으나, 최근 보안이 강화된 vsftpd(very secure FTP daemon)를 기본으로 사용하는 추세이다.

### inetd vs standalone
* inted : 슈퍼 데몬이라도 부르며, 평소에 작동하고 있다가 필요할 때마다 ftp 데몬을 호출하는 방식. 평소에는 ftp 데몬이 작동하지 않기 떄문에 컴퓨터
자원을 아끼는 효과는 있지만, 서비스와 반응이 느리다.

* standalone : ftp 데몬이 독립적을 ㅗ작동한느 방식으로, 평소에도 늘 ftp 서비스가 메모리에 상주하고 있다. 자원의 낭비는 있겠지만 ftp 서비스 요청시
즉각 반응하는 장점이 있다.

## CH.14 NFS 서버 설치와 운영
파일 서버(File server) : 1대의 컴퓨터에만 저장해놓고 저장한 디렉터리를 공유하는 방식, Client에는 여유 공간이 없고 Server에는 여유 공간이 많이 있는 경우 Client가 Server의 공간을 공유해서 사용하는 방식. 이렇게 **리눅스 컴퓨터끼리** 저장공간을 공유할 수 있도록 하는 서비스가 NFS(Network File System)이다.

> NFS 서버는 리눅스끼리 공유하는것이 원칙이다. Windows도 home 이상의 에디션은 지원한다. 

## CH.15 Samba 서버 설치와 운영

Samba : Windows에서 공유한 폴더와 프린터를 리눅스에서 자유롭게 사용하기 위해 만들어짐. SMB 프로토콜을 사용한다.

> SMB(Server Message Block)또는 CIFS(Common Internet File System) : 네트워크 상 존재하는 노드들 간에 자원을 공유할 수 있도록 설계뙨 프로토콜이다. 주로 네트워크에 연결된 컴퓨터끼리 파일, 프린터, 포트 또는 기타 메시지를 전달하는데 사용된다. SMB는 여러 운영체제(도스, 윈도우, NT, OS/2, 유닉스 등)간 자원 공유를 쉽게 해줄 목적으로 만들어졌다.

> 윈도우 10이상의 버전은 SMB의 버전이 달라서 **protocol negotiation failed: NT_STATUS_CONNECTION_RESET** 이 뜬다. 이때 맨 마지막에 -m SMB2로 명시하고 실행하면 문제없이 연결된다.

* NFS,Samba : NFS는 리눅스(또는 유닉스) 사이에서 저장 공간을 공유하지만, Samba는 리눅스(또는 유닉스)와 Windows 사이에 저장 공간을 공유하는 것이다. 그러므로 리눅스/유닉스/Windows가 혼재한 시스템이라면 NTS, Samba 모두 구축하는것이 좋다.

## CH.16 DHCP 서버 설치와 운영

DHCP(Dynamic Host Configuration Protocol) : 사용하지 않는(비어있는)IP를 요청을 한 컴퓨터에게 자동으로 할당해주는 것

DHCP서버는 회사나 인트라넷을 사용하는 환경에서, 서버관리자가 수동으로 IP를 나눠주는 것이 아닌 자동으로 IP서버를 나눠주는 옵션을 가지고 있다. 이 경우
한 컴퓨터가 네트워크에 접속하여 계속 사용하면 문제가 없지만, 더이상 접속하지 않는 경우 제한된 IP를 독점하는 경우가 발생 할 수 있다.
이를 막기위해 DHCP서버에는 IP의 임대기간이 정해져있다. 이 기간 후에도 계속 접속을 요청한다면 사용기간을 연장해 주지만, 아닌경우 IP를 회수한다.

## CH.17 프록시 서버 설치와 운영

프록시는 대리인이라는 의미로, 웹 환경에서의 프록시 서버는 웹 클라이언트와 웹 서버 사이에서 요청한 데이터를 전달하는 역할이다. 이 때 프록시 서버는 웹 서버에 가져온 데이터를 웹 클라이언트에 전송한 후 데이터를 캐시에 저장한다. 그리고 웹 클라이언트가 같은 데이터를 요청하면 자신의 캐시에서 해당 데이터를 보낸다. 이런 과정으로 웹 클라이언트에게 빠르게 데이터를 보낼 수 있다.

> 사용하는 패키지는 squid3이다.

## CH.18 방화벽 컴퓨터를 만들자

내부(인트라넷)의 사용자는 외부의 인터넷을 사용하면서 외부는 내부로 침입할 수 없게 하는 방법을 만들어야 했고 보편적으로 많이 사용하는 방법이
흔히 사설 IP(Priavte IP) 라고 불리는 nonroutable IP 주소를 이용하는 것이다.

> 사설IP는 내부 컴퓨터 사이에 트래픽은 허용하면서 외부 인터넷과의 접속은 허용 또는 제한할 수 있는 좋은방법이다.
사설 IP의 주소 범위는 10.0.0.0 ~ 10.255.255.255, 172.16.0.0 ~ 172.31.255.255, 192.168.0.0 ~ 192.168.255.255의 세 범위가 있다.

하지만 사설 IP 주소의 컴퓨터 또한 외부 인터넷으로 나갈 수 없는데. 이를 가능하게 하는 것이 IP 마스커레이딩(Masquerading, 위장)이다.

## CH.19 PXE 설치 서버

PXE(Preboot Execution Environment)로 아직 운영체제가 설치되지 않은 컴퓨터가 네트워크를 통해 PXE 서버에 접속해서 부팅되도록 해주는 인터페이스를
지칭하는 용어다.

> 사용하는 패키지

* isc-dhcp-server : dhcp 서버
* tftpd-hpa(TFTP Trivial File Transfer Protocol): FTP 보다 더 단순한 방식으로 파일을 전송하기 위한 프로토콜, PXE방식을 사용하려면, tsize를 지원하는 TFTP 서버가 있어야 한다. 
* inetutils-inetd, vsftpd, pxelinux

### 킥스타트
하지만 PXE방식만으로는 설치시 일일히 설정을 해줘야 하는 단점이 있는데, 이를 극복한 것이 킥스타트다. 일반적으로 킥스타트는 PXE와 함께 구성해 사용한다.

> 사용하는 패키지
* stsem-config-kickstart
